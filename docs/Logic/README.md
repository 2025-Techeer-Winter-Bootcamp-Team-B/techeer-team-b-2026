# 🔧 로직 문서 (Logic)

SWEETHOME의 핵심 로직과 알고리즘을 설명합니다.

---

## 📁 문서 목록

| 문서 | 설명 |
|------|------|
| [AuthFlow.md](./AuthFlow.md) | Clerk 기반 인증 플로우 |
| [SearchAlgorithm.md](./SearchAlgorithm.md) | 2단계 검색 알고리즘 |
| [MatchingAlgorithm.md](./MatchingAlgorithm.md) | 아파트 매칭 알고리즘 |
| [StatisticsCalculation.md](./StatisticsCalculation.md) | RVOL, 4분면 등 통계 계산 |
| [CacheStrategy.md](./CacheStrategy.md) | Redis 캐싱 전략 |

---

## 🎯 핵심 로직 개요

### 1. 인증 플로우

```
사용자 → Clerk UI → JWT 발급 → API 호출 → 백엔드 검증 → DB 조회/생성
```

### 2. 검색 알고리즘

```
검색어 입력
    ↓
1단계: PREFIX 검색 (인덱스)
    ↓
결과 충분? → YES → 반환
    ↓ NO
2단계: pg_trgm 유사도 검색
    ↓
결과 병합 후 반환
```

### 3. 아파트 매칭

```
API 아파트 데이터
    ↓
1단계: 시군구 코드 필터링
    ↓
2단계: 동(읍/면) 필터링
    ↓
3단계: 아파트명 매칭 (6가지 전략)
    ↓
매칭된 아파트 반환
```

### 4. 통계 계산

```
RVOL = 현재 거래량 / 과거 평균 거래량

4분면 = (매매 변화율, 전세 변화율) 기반 분류
```

### 5. 캐싱 전략

```
요청 → 캐시 확인 → HIT → 캐시 반환
                  ↓ MISS
           DB 조회 → 캐시 저장 → 반환
```

---

## 📊 성능 지표

| 로직 | 개선 전 | 개선 후 | 개선율 |
|------|---------|---------|--------|
| 검색 | 2-3초 | 50-100ms | **95%↓** |
| 통계 쿼리 | 3-5초 | 100-200ms | **95%↓** |
| 아파트 매칭 | 정확도 70% | 정확도 95% | **36%↑** |
| 캐시 히트 | 0% | 80%+ | - |
